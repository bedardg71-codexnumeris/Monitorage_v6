062-Demande

CONTEXTE : Application de monitorage pédagogique (index3.html). Nous avons développé plusieurs onglets dans la sous-navigation des Réglages. Ces sections servent à définir des paramètres qui serviront dans les sections Étudiant·es, Présences, Évaluations. Nous sommes présentement dans l'onglet sous-nav «Productions» de la nav principale «Réglas». 

OBJECTIF : 

Je veux créer une nouvelle production (artefact de portfolio), mais je ne peux pas la sauvegarder parce qu'un modal m'informe que je n'ai pas rempli tous les champs. Cependant, avec un artefact de portfolio, le champ «pondération» n'est pas nécessaire puisque c'est le portfolio lui-même qui compte pour 60%, indépendamment des artefacts qui le constituent. Comprends-tu ?
J'ai besoin que la sauvegarde se fasse en ignorant la pondération de l'artefact.


ZONES AUTORISÉES : NE PAS toucher aux autres éléments de contenu

NOMS STABLES : Respecter et conserver tous les noms dans NOMS_STABLES.json - AUCUN renommage

CODE : 

                                <small id="msgPonderationArtefact"
                                    style="display: none; padding: 10px; background: var(--bleu-pale); border-radius: 4px; color: var(--bleu-principal); font-size: 0.85rem; margin-top: 10px;">
                                    ℹ️ Les artefacts individuels n'ont pas de pondération propre. C'est le Portfolio
                                    conteneur qui définit la pondération globale.
                                </small>



-----

unction gererChangementTypeProduction() {
            const type = document.getElementById('productionType').value;
            const champsPortfolio = document.getElementById('champsPortfolio');
            const divPonderation = document.getElementById('productionPonderation').parentElement;
            const divGrille = document.getElementById('productionGrille').parentElement;
            const msgPonderation = document.getElementById('msgPonderationArtefact');

            // Réinitialiser tout d'abord
            champsPortfolio.style.display = 'none';
            divPonderation.style.display = 'block';
            divGrille.style.display = 'block';
            if (msgPonderation) msgPonderation.style.display = 'none';

            // Appliquer selon le type
            if (type === 'portfolio') {
                // Portfolio conteneur : afficher config, masquer grille
                champsPortfolio.style.display = 'block';
                divGrille.style.display = 'none';
            } else if (type === 'artefact-portfolio') {
                // Artefact individuel : masquer pondération, afficher message
                divPonderation.style.display = 'none';
                if (msgPonderation) msgPonderation.style.display = 'block';
            }
        }

-----

function sauvegarderProductionProduction(productionNum) {
            const titre = document.getElementById('productionTitre').value.trim();
            const description = document.getElementById('productionDescription').value.trim();
            const type = document.getElementById('productionType').value;
            const ponderation = parseInt(document.getElementById('productionPonderation').value) || 0;
            const objectif = document.getElementById('productionObjectif').value.trim();
            const tache = document.getElementById('productionTache').value.trim();

            if (!titre || !type || ponderation === 0) {
                alert('Veuillez remplir tous les champs obligatoires (Titre, Type et Pondération)');
                return;
            }

            let evaluations = JSON.parse(localStorage.getItem('listeGrilles') || '[]');

            if (productionEnEdition) {
                // Modifier la production existante
                const index = evaluations.findIndex(e => e.id === productionEnEdition);
                if (index !== -1) {
                    evaluations[index] = {
                        ...evaluations[index],
                        titre,
                        description,
                        type,
                        ponderation,
                        objectif,
                        tache
                    };
                }
            } else {
                // Ajouter Nouvelle grille d'évaluation
                const nouvelleEval = {
                    id: 'PROD' + Date.now(), // Utiliser timestamp pour ID unique
                    titre,
                    description,
                    type,
                    ponderation,
                    objectif,
                    tache,
                    verrouille: false
                };
                evaluations.push(nouvelleEval);
            }

            localStorage.setItem('listeGrilles', JSON.stringify(evaluations));

            annulerFormProduction();
            afficherTableauProductions();
            mettreAJourPonderationTotale();

            // Afficher la notification de succès si la fonction existe
            if (typeof afficherNotificationSucces === 'function') {
                afficherNotificationSucces(productionEnEdition ? 'Production modifiée avec succès !' : 'Production ajoutée avec succès !');
            }

            // Mettre à jour le statut des modalités si la fonction existe
            if (typeof mettreAJourStatutModalites === 'function') {
                mettreAJourStatutModalites();
            }

            productionEnEdition = null;
        }


ATTENDU : 

FORMAT : Patch minimal uniquement