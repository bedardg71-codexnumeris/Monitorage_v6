# üìã Plan de match - Syst√®me d'indices A-C-P avec PAN
## Version 1.0 - 20 octobre 2025

---

## üéØ OBJECTIF GLOBAL

Impl√©menter un syst√®me complet de calcul et d'affichage des indices p√©dagogiques A-C-P (Assiduit√©, Compl√©tion, Performance) supportant deux pratiques de notation :
- **Sommative** : Notation traditionnelle sur l'ensemble du trimestre
- **Alternative (PAN)** : Pratique Alternative de Notation focalis√©e sur des artefacts s√©lectionn√©s

Le syst√®me doit √™tre **modulaire**, **configurable** et **persistant** via localStorage.

---

## üìê ARCHITECTURE DU SYST√àME

```
MODULES G√âN√âRATEURS (source de v√©rit√©)
‚îú‚îÄ trimestre.js ‚Üí calendrierComplet ‚úÖ
‚îî‚îÄ horaire.js ‚Üí seancesCompletes ‚úÖ

MODULES CALCULATEURS (calculent les indices)
‚îú‚îÄ saisie-presences.js ‚Üí Indices A (assiduit√©)
‚îú‚îÄ portfolio.js ‚Üí Indices C et P (compl√©tion/performance)
‚îî‚îÄ [stockage dans localStorage]

MODULE SYNTH√àSE (lit et combine)
‚îî‚îÄ tableau-bord.js ‚Üí Lit indices, calcule composites, affiche
```

---

## üìä D√âFINITIONS DES INDICES

### Indices primaires

| Indice | Sommatif | Alternatif (PAN) |
|--------|----------|------------------|
| **Assiduit√© (A)** | Total heures pr√©sentes √∑ Total heures donn√©es | Heures des 3 derniers cours √∑ 12h |
| **Compl√©tion (C)** | Artefacts remis √∑ Total attendus | Ratio sur artefacts s√©lectionn√©s |
| **Performance (P)** | Moyenne tous artefacts | Moyenne artefacts s√©lectionn√©s |

### Indices composites (calcul√©s dans tableau-bord)
- **Mobilisation** = A √ó C
- **Rendement** = C √ó P  
- **Engagement** = A √ó C √ó P
- **Risque d'√©chec** = 1 - (A √ó C √ó P)

### Vocabulaire important
- **S√©ance** = 2h (un bloc lundi OU mercredi)
- **Cours** = 4h (une semaine compl√®te = 2 s√©ances)
- **3 derniers cours** = 12h (3 semaines √ó 4h)

---

## üîß √âTAPE 1 : Configuration des r√©glages

### Fichiers √† modifier
- `js/config.js` ou section R√©glages dans l'interface

### Param√®tres √† ajouter

```javascript
// Structure des r√©glages de notation
{
    pratiqueNotation: "sommative" | "alternative",
    
    // Si alternative (PAN)
    configPAN: {
        typePAN: "maitrise" | "specifications" | "denotation",
        
        // Pour les artefacts
        methodeSelection: "meilleurs" | "derniers",
        nombreArtefacts: 3,  // nombre d'artefacts √† consid√©rer
        
        // Pour l'assiduit√© (toujours temporelle)
        nombreCours: 3  // derniers cours pour assiduit√© PAN
    },
    
    // Configuration d'affichage
    affichageTableauBord: {
        afficherSommatif: true,
        afficherAlternatif: true  // Pour recherche/exp√©rimentation
    }
}
```

### Interface utilisateur
- [ ] Ajouter section "Configuration PAN" dans R√©glages
- [ ] Cases √† cocher pour affichage tableau de bord
- [ ] Validation : au moins un type d'affichage actif

---

## üîß √âTAPE 2 : Module saisie-presences.js

### Objectif
Calculer et stocker les indices d'assiduit√© selon les r√©glages

### Fonctions √† cr√©er/modifier

```javascript
// Nouvelle fonction principale
function calculerEtSauvegarderIndicesAssiduite() {
    const config = obtenirConfigNotation();
    const indices = {
        sommatif: {},
        alternatif: {},
        dateCalcul: new Date().toISOString()
    };
    
    // Pour chaque √©tudiant
    etudiants.forEach(etudiant => {
        // Toujours calculer le sommatif
        indices.sommatif[etudiant.da] = calculerAssiduiteSommative(etudiant.da);
        
        // Si PAN activ√©e, calculer l'alternatif
        if (config.affichageTableauBord.afficherAlternatif) {
            indices.alternatif[etudiant.da] = calculerAssiduitePAN(etudiant.da);
        }
    });
    
    localStorage.setItem('indicesAssiduite', JSON.stringify(indices));
}

// Assiduit√© sommative
function calculerAssiduiteSommative(da) {
    const presences = // r√©cup√©rer depuis localStorage
    const totalHeuresDonnees = // calculer depuis calendrierComplet
    const totalHeuresPresentes = // sommer les pr√©sences
    return totalHeuresPresentes / totalHeuresDonnees;
}

// Assiduit√© PAN (3 derniers cours)
function calculerAssiduitePAN(da) {
    const config = obtenirConfigNotation();
    const nombreCours = config.configPAN.nombreCours || 3;
    const heuresParCours = 4;
    const totalHeuresPAN = nombreCours * heuresParCours;
    
    // Identifier les X derniers cours
    // Calculer pr√©sences sur cette p√©riode
    return heuresPresentes3DerniersCours / totalHeuresPAN;
}
```

### D√©clencheurs
- Apr√®s chaque `enregistrerPresences()`
- Au chargement de la page
- Lors de modifications du calendrier

---

## üîß √âTAPE 3 : Module portfolio.js (ou productions.js)

### Objectif
Calculer et stocker les indices de compl√©tion et performance

### Fonctions √† cr√©er/modifier

```javascript
// Calcul des indices C et P
function calculerEtSauvegarderIndicesPortfolio() {
    const config = obtenirConfigNotation();
    const indicesCompletion = {
        sommatif: {},
        alternatif: {},
        dateCalcul: new Date().toISOString()
    };
    const indicesPerformance = {
        sommatif: {},
        alternatif: {},
        dateCalcul: new Date().toISOString()
    };
    
    etudiants.forEach(etudiant => {
        // Sommatif (toujours)
        indicesCompletion.sommatif[etudiant.da] = calculerCompletionSommative(etudiant.da);
        indicesPerformance.sommatif[etudiant.da] = calculerPerformanceSommative(etudiant.da);
        
        // Alternatif si configur√©
        if (config.affichageTableauBord.afficherAlternatif) {
            const artefactsSelection = selectionnerArtefactsPAN(etudiant.da);
            indicesCompletion.alternatif[etudiant.da] = calculerCompletionPAN(etudiant.da, artefactsSelection);
            indicesPerformance.alternatif[etudiant.da] = calculerPerformancePAN(etudiant.da, artefactsSelection);
        }
    });
    
    localStorage.setItem('indicesCompletion', JSON.stringify(indicesCompletion));
    localStorage.setItem('indicesPerformance', JSON.stringify(indicesPerformance));
}

// S√©lection des artefacts selon config PAN
function selectionnerArtefactsPAN(da) {
    const config = obtenirConfigNotation();
    
    if (config.configPAN.methodeSelection === 'meilleurs') {
        // R√©cup√©rer les X meilleurs depuis le portfolio
        return obtenirMeilleursArtefacts(da, config.configPAN.nombreArtefacts);
    } else if (config.configPAN.methodeSelection === 'derniers') {
        // R√©cup√©rer les X derniers par date
        return obtenirDerniersArtefacts(da, config.configPAN.nombreArtefacts);
    }
}
```

### Points d'attention
- Les 3 meilleurs artefacts sont d√©j√† marqu√©s dans le portfolio
- G√©rer les cas o√π moins de 3 artefacts existent
- Synchroniser avec les √©valuations IDME

---

## üîß √âTAPE 4 : Module tableau-bord.js

### Objectif
Lire les indices, calculer les composites, afficher selon config

### Structure d'affichage

```javascript
function afficherIndicesTableauBord() {
    const config = obtenirConfigNotation();
    const indicesA = JSON.parse(localStorage.getItem('indicesAssiduite') || '{}');
    const indicesC = JSON.parse(localStorage.getItem('indicesCompletion') || '{}');
    const indicesP = JSON.parse(localStorage.getItem('indicesPerformance') || '{}');
    
    etudiants.forEach(etudiant => {
        const da = etudiant.da;
        
        // Affichage selon configuration
        if (config.affichageTableauBord.afficherSommatif) {
            afficherIndicesSommatifs(da, indicesA.sommatif[da], indicesC.sommatif[da], indicesP.sommatif[da]);
            
            // Calculer et afficher composites sommatifs
            const risqueSommatif = calculerRisqueEchec(
                indicesA.sommatif[da],
                indicesC.sommatif[da],
                indicesP.sommatif[da]
            );
        }
        
        if (config.affichageTableauBord.afficherAlternatif) {
            afficherIndicesPAN(da, indicesA.alternatif[da], indicesC.alternatif[da], indicesP.alternatif[da]);
            
            // Calculer et afficher composites PAN
            const risquePAN = calculerRisqueEchec(
                indicesA.alternatif[da],
                indicesC.alternatif[da],
                indicesP.alternatif[da]
            );
        }
    });
}

// Calcul du risque d'√©chec
function calculerRisqueEchec(a, c, p) {
    return 1 - (a * c * p);
}
```

### Interface visuelle
- Colonnes s√©par√©es pour sommatif/PAN si les deux activ√©s
- Code couleur pour les seuils de risque
- Indicateurs visuels de tendance (‚Üó ‚Üò)

---

## üß™ √âTAPE 5 : Tests et validation

### Tests unitaires par module

#### Test saisie-presences.js
```javascript
// Cr√©er des pr√©sences fictives
// V√©rifier calcul assiduit√© sommative = X%
// V√©rifier calcul assiduit√© PAN (3 derniers cours) = Y%
// V√©rifier localStorage contient les bonnes valeurs
```

#### Test portfolio.js
```javascript
// Cr√©er des √©valuations fictives
// Marquer 3 meilleurs artefacts
// V√©rifier indices C et P sommatifs
// V√©rifier indices C et P sur les 3 meilleurs
```

#### Test tableau-bord.js
```javascript
// Charger indices fictifs dans localStorage
// V√©rifier affichage selon config (sommatif seul, PAN seul, les deux)
// V√©rifier calculs des composites
// V√©rifier seuils d'alerte
```

### Sc√©narios d'int√©gration

1. **Enseignant traditionnel**
   - Config : sommative uniquement
   - V√©rifier : seuls indices sommatifs affich√©s

2. **Enseignant PAN pur**
   - Config : PAN uniquement
   - V√©rifier : seuls indices alternatifs affich√©s

3. **Recherche (ton cas)**
   - Config : les deux
   - V√©rifier : comparaison c√¥te √† c√¥te

---

## üìÖ ORDRE DE D√âVELOPPEMENT SUGG√âR√â

### Phase 1 : Configuration (1-2h)
1. Ajouter param√®tres dans R√©glages
2. Cr√©er interface de configuration
3. Tester sauvegarde/lecture config

### Phase 2 : Calcul assiduit√© (2-3h)
1. Modifier `saisie-presences.js`
2. Impl√©menter calculs sommatif/PAN
3. Tester avec donn√©es r√©elles

### Phase 3 : Calcul C et P (3-4h)
1. Modifier `portfolio.js`
2. G√©rer s√©lection artefacts
3. Synchroniser avec √©valuations

### Phase 4 : Tableau de bord (2-3h)
1. Cr√©er interface adaptative
2. Impl√©menter lecture indices
3. Calculer composites
4. Ajouter visualisations

### Phase 5 : Tests et ajustements (2h)
1. Tests avec diff√©rentes configs
2. Validation des calculs
3. Optimisation performance

---

## ‚ö†Ô∏è POINTS CRITIQUES

### Ne pas oublier
- **R√©g√©n√©ration** : Recalculer apr√®s chaque modification
- **Dates** : Bien identifier les "3 derniers cours" dynamiquement
- **Cas limites** : D√©but de session, moins de 3 artefacts, etc.
- **Performance** : Cache les calculs lourds dans localStorage

### D√©pendances
- `calendrierComplet` pour identifier les cours
- `seancesCompletes` pour les heures totales
- Marqueurs portfolio pour les meilleurs artefacts

### R√©trocompatibilit√©
- Migration des donn√©es existantes si n√©cessaire
- Valeurs par d√©faut pour nouvelles configs

---

## üìù DOCUMENTATION √Ä MAINTENIR

- README avec exemples de calculs
- Commentaires dans le code sur les formules
- Guide utilisateur pour configuration PAN
- Cas d'usage pour diff√©rents types d'enseignants

---

## ‚úÖ CRIT√àRES DE SUCC√àS

1. Les indices s'affichent correctement selon la config
2. Les calculs correspondent aux formules du guide de monitorage
3. La performance reste fluide m√™me avec 30+ √©tudiants
4. Les donn√©es persistent entre les sessions
5. L'interface s'adapte aux diff√©rentes pratiques p√©dagogiques

---

**Document de r√©f√©rence pour l'impl√©mentation du syst√®me d'indices A-C-P**
*Peut √™tre utilis√© dans plusieurs conversations pour maintenir la coh√©rence*